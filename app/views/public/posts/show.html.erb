<div class="container">
  <div class="row">
    <%= @post.title %>
  </div>
  <div class="row">

    <% if @post.post_images.attached? %>
      <% @post.post_images.each do |post_image| %>
         <div style="height:180, width:130">
        <%= image_tag post_image.variant(resize: "100x130^") %>
        </div>
      <% end %>
    <% else %>
      <%= image_tag 'no_image_yoko.jpeg', size: "180x130" %>
    <% end %>

  </div>

  <div class="row">
    <%= @post.post %>
  </div>

  <div class="row">
    <!--each文で複数のものの中から1つずつ取得する-->
    <% @post.tags.pluck(:name).each do |tag_name|%>
      <%= tag_name %>
    <% end %>
  </div>
　<% if user_signed_in? && current_user.id == @post.user_id %>
    <%= link_to '編集', edit_post_path(@post.id), class: "btn btn-info" %>
    <%= link_to '削除', post_path(@post.id), method: :delete, "data-confirm"=>"本当に消しますか？", class: "btn btn-danger" %>
  <% end %>
  <%= link_to '一覧へ', posts_path, class: "btn btn-dark" %>

  <div class="row">
    <% @comments.each do |comment| %>
      <%= comment.user.name %><br>
      <%= comment.comment %><br>
        <% if comment.user == current_user %>
          <div class="comment-delete">
            <%= link_to "削除", post_comment_path(@post.id, comment.id), method: :delete, class: "btn-sm btn-danger" %>
          </div>
        <% end %>
    <% end %>
  </div>

  <div class="row">
    <% if user_signed_in? %>
      <%= form_with model: [@post, @comment], url: post_comments_path(@post), local: true, method: :POST do |f| %>
        <%= f.text_area :comment, placeholder: "コメントする" %>
        <%= f.submit 'コメントする' %>
      <% end %>
    <% end %>
  </div>

  <% if @post.favorited?(current_user) %>
    <!--一致するレコードが存在する＝すでにいいね済みの場合はdestroyアクションへ-->
    <%= link_to post_favorites_path(@post.id), method: :delete do %>
        <span style="color:red;">❤︎</span>
    <% end %>
  <% else %>
    <!--一致するレコードが存在しない＝まだいいねしていない場合はcreateアクションへ-->
    <%= link_to post_favorites_path(@post.id), method: :post do %>
        <span>❤︎</span>
    <% end %>
  <% end %>

</div>

